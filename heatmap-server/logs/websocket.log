
> heatmap-server@1.0.0 websocket
> node websocket-server.js

🚀 WebSocket Server iniciado na porta 3002
🌐 Servidor HTTP para diagnósticos iniciado na porta 3003
✅ Nova conexão WebSocket: ::1
✅ Nova conexão WebSocket: ::1
📱 Sessão iniciada: 33592a41-f2a9-4283-b82a-a7d2c528c83c
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:57:21)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_started {
  sessionId: '33592a41-f2a9-4283-b82a-a7d2c528c83c',
  url: 'http://localhost:56844/',
  timestamp: 1751700329813
}
✅ Nova conexão WebSocket: ::1
📱 Sessão iniciada: 7ce640e8-f17c-463b-9984-a9dcaf46876f
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:57:21)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_started {
  sessionId: '7ce640e8-f17c-463b-9984-a9dcaf46876f',
  url: 'http://localhost:62174/',
  timestamp: 1751700330072
}
✅ Nova conexão WebSocket: undefined
✅ Nova conexão WebSocket: ::1
✅ Nova conexão WebSocket: ::1
🔚 Sessão finalizada: 33592a41-f2a9-4283-b82a-a7d2c528c83c
📊 Resumo da Sessão 33592a41-f2a9-4283-b82a-a7d2c528c83c:
   ⏱️  Duração: 17s
   📸 Imagens: 0
   🖱️  Pontos de Mouse: 0
   👆 Cliques: 0
   🌐 URL: http://localhost:56844/
⚠️  DIAGNÓSTICO - Sessão 33592a41-f2a9-4283-b82a-a7d2c528c83c sem imagens:
   - Duração da sessão: 17s
   - Última atividade: 05/07/2025, 04:25:29
   - URL da sessão: http://localhost:56844/
   - Possíveis causas:
     • Flutter não está enviando imagens
     • Problemas de conectividade WebSocket
     • Sessão muito curta (< 10s)
     • Problemas no processo de captura
   - Nenhum arquivo encontrado no diretório de uploads
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:182:25)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_ended {
  sessionId: '33592a41-f2a9-4283-b82a-a7d2c528c83c',
  timestamp: 1751700346995
}
🔌 Conexão WebSocket fechada: 33592a41-f2a9-4283-b82a-a7d2c528c83c
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:321:13)
    at WebSocket.emit (node:events:536:35)
    at WebSocket.emitClose (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:272:10)
    at Socket.socketOnClose (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1341:15)
    at Socket.emit (node:events:524:28) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
✅ Nova conexão WebSocket: ::1
📱 Sessão iniciada: c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:57:21)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_started {
  sessionId: 'c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46',
  url: 'http://localhost:5000/',
  timestamp: 1751700350689
}
🔚 Sessão finalizada: c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📊 Resumo da Sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46:
   ⏱️  Duração: 0s
   📸 Imagens: 0
   🖱️  Pontos de Mouse: 0
   👆 Cliques: 0
   🌐 URL: http://localhost:5000/
⚠️  DIAGNÓSTICO - Sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46 sem imagens:
   - Duração da sessão: 0s
   - Última atividade: 05/07/2025, 04:25:50
   - URL da sessão: http://localhost:5000/
   - Possíveis causas:
     • Flutter não está enviando imagens
     • Problemas de conectividade WebSocket
     • Sessão muito curta (< 10s)
     • Problemas no processo de captura
   - Nenhum arquivo encontrado no diretório de uploads
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:182:25)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_ended {
  sessionId: 'c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46',
  timestamp: 1751700351152
}
✅ Nova conexão WebSocket: ::1
✅ Nova conexão WebSocket: ::1
✅ Nova conexão WebSocket: ::1
🧹 Limpeza solicitada para sessão: 513763b6-1ba7-4aea-ae64-d023081a8718
🧹 Sessão 513763b6-1ba7-4aea-ae64-d023081a8718 limpa: 0 arquivos removidos
✅ Nova conexão WebSocket: undefined
✅ Nova conexão WebSocket: ::1
👆 Dados de cliques recebidos: 1 cliques da sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📁 Dados de cliques salvos: click_data_c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46_1751700375012.json
👆 Dados de cliques recebidos: 2 cliques da sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📁 Dados de cliques salvos: click_data_c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46_1751700375869.json
👆 Dados de cliques recebidos: 3 cliques da sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📁 Dados de cliques salvos: click_data_c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46_1751700376303.json
✅ Nova conexão WebSocket: ::1
👆 Dados de cliques recebidos: 4 cliques da sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📁 Dados de cliques salvos: click_data_c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46_1751700377133.json
🖱️ Dados de mouse recebidos: 234 pontos da sessão c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
📁 Dados de mouse salvos: mouse_data_c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46_1751700384402.json
🔚 Sessão finalizada: c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:182:25)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_ended {
  sessionId: 'c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46',
  timestamp: 1751700385378
}
🔌 Conexão WebSocket fechada: c3aeec4d-5c93-4751-9dfb-0f4a7eda0b46
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:321:13)
    at WebSocket.emit (node:events:536:35)
    at WebSocket.emitClose (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:272:10)
    at Socket.socketOnClose (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1341:15)
    at Socket.emit (node:events:524:28) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
✅ Nova conexão WebSocket: ::1
📱 Sessão iniciada: 32aa1113-631d-4c8c-af52-8d3294696ba6
Erro ao enviar notificação: Error: Cannot find module 'axios'
Require stack:
- /Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at notifyMainServer (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:421:23)
    at WebSocket.<anonymous> (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js:57:21)
    at WebSocket.emit (node:events:524:28)
    at Receiver.receiverOnMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:524:28)
    at Receiver.dataMessage (/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/node_modules/ws/lib/receiver.js:596:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/nathan.oliveira/Documents/test/clarity/heatmap-server/websocket-server.js'
  ]
}
📡 Admin Event: session_started {
  sessionId: '32aa1113-631d-4c8c-af52-8d3294696ba6',
  url: 'http://localhost:5000/',
  timestamp: 1751700386723
}
📈 Status: 2 clientes ativos, 2 sessões
📋 Sessões ativas:
   🔸 7ce640e8-f17c-463b-9984-a9dcaf46876f: 0 imagens, 57s, ativo
   🔸 32aa1113-631d-4c8c-af52-8d3294696ba6: 0 imagens, 0s, ativo
🖱️ Dados de mouse recebidos: 128 pontos da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de mouse salvos: mouse_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700396724.json
✅ Nova conexão WebSocket: undefined
✅ Nova conexão WebSocket: ::1
✅ Nova conexão WebSocket: ::1
📈 Status: 2 clientes ativos, 2 sessões
📋 Sessões ativas:
   🔸 7ce640e8-f17c-463b-9984-a9dcaf46876f: 0 imagens, 117s, ativo
   🔸 32aa1113-631d-4c8c-af52-8d3294696ba6: 0 imagens, 60s, ativo
👆 Dados de cliques recebidos: 1 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700460553.json
👆 Dados de cliques recebidos: 2 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700461336.json
👆 Dados de cliques recebidos: 3 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700462209.json
👆 Dados de cliques recebidos: 4 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700463226.json
👆 Dados de cliques recebidos: 5 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700463938.json
👆 Dados de cliques recebidos: 6 cliques da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de cliques salvos: click_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700464826.json
🖱️ Dados de mouse recebidos: 324 pontos da sessão 32aa1113-631d-4c8c-af52-8d3294696ba6
📁 Dados de mouse salvos: mouse_data_32aa1113-631d-4c8c-af52-8d3294696ba6_1751700466731.json
📈 Status: 2 clientes ativos, 2 sessões
📋 Sessões ativas:
   🔸 7ce640e8-f17c-463b-9984-a9dcaf46876f: 0 imagens, 177s, ativo
   🔸 32aa1113-631d-4c8c-af52-8d3294696ba6: 0 imagens, 120s, ativo
